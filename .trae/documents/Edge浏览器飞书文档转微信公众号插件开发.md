# Edge浏览器飞书文档转微信公众号插件开发

## 插件概述
开发一个Edge浏览器插件，用于解决从飞书文档复制内容到微信公众号编辑器时格式错乱的问题。插件将自动重新渲染飞书文档内容，并提供所见即所得的复制功能。

## 核心功能
1. **内容提取**：从飞书文档页面提取文章内容
2. **重新渲染**：将提取的内容重新渲染为符合微信公众号要求的格式
3. **一键复制**：提供复制按钮，将渲染后的内容复制到剪贴板
4. **实时预览**：在插件弹窗中预览渲染后的效果

## 插件结构
```
feishu-plugin/
├── manifest.json          # 插件配置文件
├── content.js             # 内容脚本，用于在飞书文档页面执行
├── popup.html             # 插件弹窗HTML
├── popup.js               # 弹窗逻辑
├── background.js          # 后台脚本
└── styles.css             # 渲染样式
```

## 实现步骤

### 1. 插件配置 (manifest.json)
- 定义插件基本信息
- 配置内容脚本，指定在飞书文档页面运行
- 配置权限，包括剪贴板访问权限

### 2. 内容提取 (content.js)
- 编写飞书文档内容提取逻辑
- 识别飞书文档的DOM结构，提取标题、段落、图片等元素
- 将提取的内容发送给弹窗或后台脚本

### 3. 重新渲染逻辑
- 设计符合微信公众号要求的HTML结构
- 处理文字样式：字体、大小、颜色、加粗、斜体等
- 处理图片：确保图片URL可访问，设置合适的宽度
- 处理列表、表格等复杂元素

### 4. 弹窗设计 (popup.html + popup.js)
- 设计简洁的弹窗界面，包含预览区域和复制按钮
- 接收来自内容脚本的提取内容
- 在预览区域渲染内容
- 实现复制功能，使用`clipboardData.setData('text/html')`确保HTML格式

### 5. 测试与优化
- 测试不同类型的飞书文档内容
- 验证复制到微信公众号的效果
- 优化渲染样式，确保与飞书文档视觉一致
- 处理边界情况，如特殊格式、复杂表格等

## 技术要点
- 使用WebExtensions API开发Edge浏览器插件
- 利用DOM操作提取和重新渲染内容
- 使用Clipboard API实现HTML格式复制
- 确保渲染样式符合微信公众号编辑器要求

## 预期效果
用户在飞书文档页面点击插件图标，弹窗中显示重新渲染后的内容，点击复制按钮后，内容将以正确的格式复制到剪贴板，粘贴到微信公众号编辑器时保持与预览一致的效果。